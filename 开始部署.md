# 🚀 开始部署到魔搭平台

## 🎯 你的项目支持两种部署模式

### 模式选择

| 模式 | 环境变量数量 | 推荐场景 | 配置文件 |
|------|-------------|----------|----------|
| **单模型** | 3个 | 新手/测试/预算有限 | `ms_deploy_single_model.json` |
| **双模型** | 6个 | 生产/追求性能 | `ms_deploy_dual_model.json` |

## ⚡ 快速开始 - 单模型模式 (推荐)

### 为什么选择单模型?
- ✅ 配置最简单 - 只需3个环境变量
- ✅ 不容易出错 - 配置项少
- ✅ 功能完整 - 所有功能都可用
- ✅ 成本更低 - 只用一个模型

### 步骤1: 在魔搭平台配置环境变量

登录魔搭平台,进入你的创空间,添加以下环境变量:

```
MODEL_NAME = deepseek-chat
OPENAI_API_KEY = sk-你的DeepSeek密钥
OPENAI_BASE_URL = https://api.deepseek.com/v1
```

**就这3个! 不需要配置其他的!**

### 步骤2: 点击重新构建

在魔搭平台点击"重新构建"按钮,等待3-5分钟。

### 步骤3: 验证部署

部署成功后,查看日志应该看到:
```
ℹ️ 未配置DETECTION_MODEL_NAME，将使用主模型进行分析（单模型模式）
✓ 生成模型: deepseek-chat
INFO:     Uvicorn running on http://0.0.0.0:7860
INFO:     Application startup complete.
```

**看到这些就说明部署成功了! 🎉**

## 🚀 进阶部署 - 双模型模式

### 为什么选择双模型?
- ✅ 性能更好 - 分析任务使用专门的推理模型
- ✅ 推理更强 - deepseek-reasoner专注复杂推理
- ✅ 对话更优 - deepseek-chat专注自然对话

### 步骤1: 在魔搭平台配置环境变量

```
MODEL_NAME = deepseek-chat
OPENAI_API_KEY = sk-你的密钥
OPENAI_BASE_URL = https://api.deepseek.com/v1

DETECTION_MODEL_NAME = deepseek-reasoner
DETECTION_API_KEY = sk-你的密钥 (可以和上面相同)
DETECTION_BASE_URL = https://api.deepseek.com/v1
```

**重要**: `DETECTION_API_KEY` 可以和 `OPENAI_API_KEY` 使用相同的密钥!

### 步骤2: 点击重新构建

### 步骤3: 验证部署

查看日志应该看到:
```
✓ 双模型架构已初始化
  - 生成模型: deepseek-chat (用于发言生成)
  - 分析模型: deepseek-reasoner (用于消息分析)
INFO:     Uvicorn running on http://0.0.0.0:7860
INFO:     Application startup complete.
```

## 🔑 如何获取API密钥

1. 访问 [DeepSeek平台](https://platform.deepseek.com/)
2. 注册/登录账号
3. 进入"API Keys"页面
4. 创建新的API密钥
5. 复制密钥(格式: `sk-...`)

**注意**: 
- 确保账户有足够余额
- 密钥只显示一次,请妥善保存
- 不要将密钥提交到Git

## ❓ 常见问题

### Q1: 我应该选择哪个模式?
**A**: 新手推荐单模型,简单不容易出错。等熟悉后再升级到双模型。

### Q2: 单模型功能会受限吗?
**A**: 不会! 所有功能都正常,只是性能略有差异。

### Q3: 双模型一定要两个密钥吗?
**A**: 不需要! `DETECTION_API_KEY` 和 `OPENAI_API_KEY` 可以用同一个。

### Q4: 如何从单模型升级到双模型?
**A**: 在魔搭平台添加3个 `DETECTION_*` 环境变量,然后重新构建即可。

### Q5: 部署失败怎么办?
**A**: 
1. 检查环境变量是否正确设置
2. 确认API密钥有效
3. 查看部署日志中的错误信息
4. 参考 [魔搭部署指南.md](魔搭部署指南.md)

## 📊 两种模式对比

| 特性 | 单模型 | 双模型 |
|------|--------|--------|
| 环境变量 | 3个 | 6个 |
| 配置难度 | ⭐ 简单 | ⭐⭐ 中等 |
| 对话质量 | ⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 推理能力 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| 成本 | 低 | 中 (约贵25%) |
| 推荐场景 | 开发/测试 | 生产环境 |

## 📚 详细文档

如需更多信息,请查看:

- 📖 [部署配置对比.md](部署配置对比.md) - 详细对比两种模式
- 🎯 [魔搭平台单模型部署说明.md](魔搭平台单模型部署说明.md) - 单模型详解
- 📋 [魔搭部署指南.md](魔搭部署指南.md) - 完整部署指南
- ✅ [部署前最终检查.md](部署前最终检查.md) - 检查清单

## 🎯 推荐部署流程

### 第一次部署 (推荐)
1. ✅ 使用**单模型模式**
2. ✅ 只配置3个环境变量
3. ✅ 验证功能正常
4. ✅ 熟悉系统操作

### 后续优化 (可选)
1. 📈 升级到**双模型模式**
2. 📈 配置额外3个环境变量
3. 📈 享受更好的性能

## ✅ 部署成功标志

部署成功后,你应该能:
- ✓ 访问创空间URL
- ✓ 看到游戏界面
- ✓ 创建游戏
- ✓ AI玩家正常对话
- ✓ 游戏流程完整

## 🎮 开始游戏

部署成功后:
1. 访问你的创空间URL
2. 选择游戏配置
3. 点击"开始游戏"
4. 享受AI狼人杀! 🎉

---

## 💡 最后提醒

- ✅ 代码已经提交到Git
- ✅ 所有检查都已通过
- ✅ 配置文件已准备好
- ✅ 文档已完善

**现在只需要在魔搭平台配置环境变量,然后点击"重新构建"!**

**祝你部署顺利! 🚀**

---

**需要帮助?** 查看 [魔搭部署指南.md](魔搭部署指南.md) 的故障排查部分。
